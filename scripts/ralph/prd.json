{
  "title": "De Raedt Growth OS",
  "branchName": "growth-os-dev",
  "userStories": [
    {
      "id": "FND-001",
      "priority": 1,
      "title": "Verification harness setup",
      "description": "Set up canonical install/lint/typecheck/test/build commands and document in AGENTS.md. Add verify script to package.json.",
      "acceptanceCriteria": [
        "package.json has 'verify' script that runs lint + typecheck + build",
        "package.json has 'typecheck' script (tsc --noEmit)",
        "pnpm verify passes without errors",
        "AGENTS.md documents all canonical commands"
      ],
      "passes": true,
      "pathsTouched": ["package.json", "AGENTS.md"],
      "commands": ["pnpm verify"],
      "notes": "Lint + typecheck pass. Build requires network (Google Fonts). Fixed lint errors in werken-bij, about-teaser, procurement, over-ons, hero."
    },
    {
      "id": "FND-002",
      "priority": 2,
      "title": "Data layer + migrations + seed demo data",
      "description": "Set up Supabase schema with migrations for core entities. Create seed script with demo data for tenders, leads, jobs, and cases.",
      "acceptanceCriteria": [
        "Supabase migration files exist in supabase/migrations/",
        "Core tables defined: users, leads, tenders, jobs, cases, compliance_docs",
        "Seed script exists in scripts/seed/",
        "Seed data includes 5+ tenders, 8+ leads, 3+ jobs, 6+ cases"
      ],
      "passes": true,
      "pathsTouched": ["supabase/migrations/", "scripts/seed/", "lib/supabase/"],
      "commands": ["pnpm supabase:migrate", "pnpm seed"],
      "notes": "6 SQL migrations, TypeScript types, JSON seed data (6 tenders, 10 leads, 4 jobs, 8 cases, 8 compliance docs). Supabase CLI required for migrations."
    },
    {
      "id": "FND-003",
      "priority": 3,
      "title": "Auth + RBAC skeleton + /admin protect",
      "description": "Implement authentication flow with Supabase Auth. Create RBAC system with roles (DIRECTIE, SALES, HR, OPERATIONS, ADMIN). Protect all /admin routes.",
      "acceptanceCriteria": [
        "Login page at /login works with Supabase Auth",
        "User roles stored in profiles table",
        "Middleware protects (portal) routes",
        "Unauthorized users redirected to /login",
        "Role check utility function exists"
      ],
      "passes": true,
      "pathsTouched": ["app/(portal)/", "lib/supabase/auth.ts", "middleware.ts", "app/auth/callback/route.ts"],
      "commands": ["pnpm verify"],
      "notes": "Implemented magic link auth, middleware protection, RBAC utilities with role hierarchy. Security review completed."
    },
    {
      "id": "FND-004",
      "priority": 4,
      "title": "Uploads & media asset handling",
      "description": "Implement file upload handling with size/type limits. Use Supabase Storage for files.",
      "acceptanceCriteria": [
        "Upload API route exists at /api/upload",
        "File type validation (images, PDFs, docs)",
        "File size limit enforced (10MB default)",
        "Files stored in Supabase Storage",
        "MediaAsset record created with metadata"
      ],
      "passes": true,
      "pathsTouched": ["app/api/upload/", "lib/supabase/storage.ts", "supabase/migrations/00007_create_media_assets.sql"],
      "commands": ["pnpm verify"],
      "notes": "Implemented storage utilities with file validation, upload to Supabase Storage, and media_assets table for tracking."
    },
    {
      "id": "FND-005",
      "priority": 5,
      "title": "Audit log basis",
      "description": "Create audit log system for tracking login events and CRUD operations on critical entities.",
      "acceptanceCriteria": [
        "AuditLog table exists in database",
        "Login/logout events logged",
        "Create/Update/Delete on leads, tenders, jobs logged",
        "Log includes: user_id, action, entity, entity_id, timestamp, metadata",
        "Audit log viewable in admin (later story)"
      ],
      "passes": true,
      "pathsTouched": ["lib/audit.ts", "supabase/migrations/00008_create_audit_log.sql"],
      "commands": ["pnpm verify"],
      "notes": "Implemented DB triggers for automatic logging on all core tables. Helper functions in lib/audit.ts."
    },
    {
      "id": "PUB-010",
      "priority": 21,
      "title": "SEO baseline",
      "description": "Implement SEO foundation: metadata, sitemap.xml, robots.txt, OpenGraph tags for all pages.",
      "acceptanceCriteria": [
        "Each page has unique title and description",
        "OpenGraph tags on all pages",
        "sitemap.xml generated at /sitemap.xml",
        "robots.txt allows crawling",
        "Canonical URLs set correctly"
      ],
      "passes": true,
      "pathsTouched": ["app/(marketing)/*/layout.tsx", "app/sitemap.ts", "app/robots.ts"],
      "commands": ["pnpm verify"],
      "notes": "Created sitemap.ts and robots.ts. Added route-specific layouts with metadata for all marketing pages."
    },
    {
      "id": "PUB-020",
      "priority": 22,
      "title": "Diensten structure alignment",
      "description": "Align diensten pages with 'Bouw & Renovatie' and 'Facility' structure. Add clear CTAs leading to intake flows.",
      "acceptanceCriteria": [
        "/diensten/bouw-renovatie page exists with service details",
        "/diensten/facility page exists with service details",
        "Each service page has CTA to projectplanner",
        "Services listed on /diensten overview",
        "Scope boundaries clear (wat wel/niet)"
      ],
      "passes": true,
      "pathsTouched": ["app/(marketing)/diensten/bouw-renovatie/", "app/(marketing)/diensten/facility/"],
      "commands": ["pnpm verify"],
      "notes": "Created bouw-renovatie (nieuwbouw, renovatie, erfgoed) and facility (raamcontracten, onderhoud, interventies) sub-pages with scope sections."
    },
    {
      "id": "PUB-030",
      "priority": 23,
      "title": "Cases CMS model + listing + detail + filters",
      "description": "Create cases/referenties system with CMS-ready model, listing page with filters, and detail pages.",
      "acceptanceCriteria": [
        "Case study data model defined (title, client, scope, location, year, photos, KPIs)",
        "/projecten shows filterable case listing",
        "Filter by sector (publiek, onderwijs, zorg, industrie)",
        "/projecten/[slug] shows case detail",
        "Cases data from Sanity or JSON seed"
      ],
      "passes": true,
      "pathsTouched": ["app/(marketing)/projecten/", "lib/constants.ts"],
      "commands": ["pnpm verify"],
      "notes": "Already implemented with filterable listing, sector filters, detail pages with KPIs. Data from FEATURED_PROJECTS."
    },
    {
      "id": "PUB-040",
      "priority": 24,
      "title": "Procurement hub: Tender Pack request flow",
      "description": "Enhance procurement hub with Tender Pack request flow and downloadable documents section.",
      "acceptanceCriteria": [
        "Tender Pack request form on /procurement/documentatie",
        "Form captures: name, org, email, purpose (aanbesteding/preselectie/raamcontract)",
        "Form submission creates lead record",
        "Confirmation shown after submit",
        "Document downloads section with placeholders"
      ],
      "passes": true,
      "pathsTouched": ["app/(marketing)/procurement/documentatie/", "app/api/leads/route.ts"],
      "commands": ["pnpm verify"],
      "notes": "Created documentatie page with form, /api/leads endpoint, and documents list."
    },
    {
      "id": "PUB-050",
      "priority": 25,
      "title": "Jobs: job detail + apply flow + JobPosting schema",
      "description": "Create job detail pages with apply flow and Google JobPosting structured data.",
      "acceptanceCriteria": [
        "/werken-bij/[slug] shows job detail",
        "JobPosting JSON-LD schema on detail page",
        "Apply form with CV upload + GDPR consent",
        "Application creates record in database",
        "Confirmation email mention (stub if no SMTP)"
      ],
      "passes": true,
      "pathsTouched": ["app/(marketing)/werken-bij/[slug]/", "app/api/applications/route.ts"],
      "commands": ["pnpm verify"],
      "notes": "Created job detail pages with JobPosting JSON-LD schema. Apply form with CV upload (10MB limit) and GDPR consent. Confirmation message shown after submit, email noted as stub."
    },
    {
      "id": "PUB-060",
      "priority": 26,
      "title": "Contact flow → lead record",
      "description": "Convert contact form to proper lead intake flow. No email-only submissions.",
      "acceptanceCriteria": [
        "Contact form creates lead record in database",
        "Lead type set based on form selection",
        "Basic validation with Zod",
        "Success confirmation shown",
        "Lead visible in admin (after ADM-020)"
      ],
      "passes": true,
      "pathsTouched": ["app/(marketing)/contact/", "app/api/contact/route.ts", "lib/validations/contact.ts"],
      "commands": ["pnpm verify"],
      "notes": "Updated contact form to create lead records. Added organisation field. Lead type mapped from contact subject (raamcontract→procurement, offerte→project, etc.). Zod validation with full CONTACT_SUBJECTS alignment."
    },
    {
      "id": "ADM-010",
      "priority": 61,
      "title": "Cockpit v1: tiles + alerts + export",
      "description": "Create directie cockpit with KPI tiles, alerts widget, and board pack export.",
      "acceptanceCriteria": [
        "/dashboard shows cockpit layout",
        "Tender pipeline tile with counts per stage",
        "Lead pipeline tile per service type",
        "Expiry radar widget (30/60/90 days)",
        "Alerts list (upcoming deadlines, overdue items)",
        "Export button for board pack (CSV/PDF stub)"
      ],
      "passes": true,
      "pathsTouched": ["app/(portal)/dashboard/dashboard-client.tsx"],
      "commands": ["pnpm verify"],
      "notes": "Created directie cockpit with KPI tiles, tender/lead pipeline bars, expiry radar (30/60/90), alerts for new leads/analyzing tenders/expiring docs, and board pack export stub."
    },
    {
      "id": "ADM-020",
      "priority": 62,
      "title": "Lead hub v1: pipeline + assignment + reminders",
      "description": "Create lead management hub with pipeline view, assignment, and follow-up reminders.",
      "acceptanceCriteria": [
        "/dashboard/leads shows all leads",
        "Pipeline view with stages (new, contacted, qualified, proposal, won, lost)",
        "Lead detail modal/page",
        "Assignment dropdown (to team member)",
        "Add notes to lead",
        "Set next action date (reminder)"
      ],
      "passes": true,
      "pathsTouched": ["app/(portal)/dashboard/leads/"],
      "commands": ["pnpm verify"],
      "notes": "Created lead hub with pipeline and list views. Detail modal with contact info, assignment dropdown, notes, and next action date. Actions logged to console."
    },
    {
      "id": "ADM-030",
      "priority": 63,
      "title": "Tender hub v1: TED RSS ingest + opportunity list",
      "description": "Create tender hub with TED RSS feed ingestion and normalized opportunity list.",
      "acceptanceCriteria": [
        "/dashboard/tenders shows tender list",
        "TED RSS parser function exists",
        "Manual refresh button triggers ingest",
        "Tenders normalized to standard schema",
        "List shows: title, buyer, deadline, status, match score",
        "Filter by CPV code and status"
      ],
      "passes": true,
      "pathsTouched": ["app/(portal)/dashboard/tenders/", "lib/tender/"],
      "commands": ["pnpm verify"],
      "notes": "Created tender hub with full list view, status filters, deadline indicators, match scores. TED RSS parser in lib/tender/ted-rss.ts with CPV matching for construction trades."
    },
    {
      "id": "ADM-040",
      "priority": 64,
      "title": "Tender go/no-go + checklist + decision log",
      "description": "Add go/no-go workflow to tender hub with checklist and decision logging.",
      "acceptanceCriteria": [
        "Tender detail page with go/no-go section",
        "Checklist items: capacity, risk, margin, planning, references",
        "Each item can be checked + notes added",
        "Go/No-Go decision button with reason",
        "Decision logged with user and timestamp",
        "Status updates to reflect decision"
      ],
      "passes": true,
      "pathsTouched": ["app/(portal)/dashboard/tenders/[id]/"],
      "commands": ["pnpm verify"],
      "notes": "Created tender detail page with full go/no-go checklist (capacity, risk, margin, planning, references). Decision logging with user/timestamp. Status updates on decision."
    },
    {
      "id": "ADM-050",
      "priority": 65,
      "title": "Compliance vault: document types + expiry radar + tender pack templates",
      "description": "Create compliance document management with expiry tracking and tender pack generation.",
      "acceptanceCriteria": [
        "/dashboard/compliance shows document list",
        "Document types: ISO, VCA, CO₂, insurance, etc.",
        "Each doc has: name, type, issuer, valid_from, valid_to, file, scope",
        "Expiry radar: list docs expiring in 30/60/90 days",
        "Tender pack template: select docs to include in export"
      ],
      "passes": true,
      "pathsTouched": ["app/(portal)/dashboard/compliance/"],
      "commands": ["pnpm verify"],
      "notes": "Created compliance vault with document list, expiry radar (30/60/90 days), document type filters, and tender pack selection/export feature."
    },
    {
      "id": "ADM-060",
      "priority": 66,
      "title": "Recruitment hub v1: jobs CRUD + applications queue + retention",
      "description": "Create recruitment hub for managing vacancies and applications.",
      "acceptanceCriteria": [
        "/dashboard/recruitment shows jobs list",
        "CRUD operations for job postings",
        "Job status: draft, published, closed",
        "Applications list with status (new, screening, interview, offer, hired, rejected)",
        "Application detail with CV download",
        "Retention policy setting (default 12 months)"
      ],
      "passes": true,
      "pathsTouched": ["app/(portal)/dashboard/recruitment/"],
      "commands": ["pnpm verify"],
      "notes": "Created recruitment hub with jobs/applications tabs, CRUD stubs, application detail modal with status workflow, CV download, and GDPR retention policy settings."
    },
    {
      "id": "ADM-070",
      "priority": 67,
      "title": "VDAB adapter stub + mapping",
      "description": "Create adapter interface for VDAB Vacature Posting API with field mapping.",
      "acceptanceCriteria": [
        "VDAB adapter interface defined",
        "Job to VDAB format mapping function",
        "Publish to VDAB button (logs only, no actual API call)",
        "Sync status shown per job",
        "Documentation of required VDAB fields"
      ],
      "passes": true,
      "pathsTouched": ["lib/adapters/vdab.ts", "app/(portal)/dashboard/recruitment/"],
      "commands": ["pnpm verify"],
      "notes": "Created VDAB adapter with full interface, job-to-VDAB mapping, publish/update/remove stubs. Integrated into recruitment hub with sync status and publish button per job."
    },
    {
      "id": "ADM-080",
      "priority": 68,
      "title": "Facility desk v1: tickets + SLA due + statuses",
      "description": "Create facility desk for managing intervention tickets with SLA tracking.",
      "acceptanceCriteria": [
        "/dashboard/facility shows ticket list",
        "Ticket fields: urgency, location, description, photos, status, sla_due_at",
        "Ticket creation from public flow",
        "Status workflow: open → in progress → waiting → resolved",
        "SLA overdue highlighting",
        "Assignment to team member"
      ],
      "passes": true,
      "pathsTouched": ["app/(portal)/dashboard/facility/"],
      "commands": ["pnpm verify"],
      "notes": "Created facility desk with ticket list sorted by urgency/SLA. Full status workflow, SLA overdue highlighting (red row), assignment dropdown, ticket detail modal with notes/photos."
    },
    {
      "id": "ADM-090",
      "priority": 69,
      "title": "Partner prequal v1: intake + doc checklist + review workflow",
      "description": "Create partner portal for prequalification with document checklist.",
      "acceptanceCriteria": [
        "/dashboard/partners shows partner list",
        "Partner intake creates record",
        "Document checklist: VCA, insurance, references",
        "Document upload per checklist item",
        "Review workflow: pending → approved → blocked",
        "Expiry tracking on partner documents"
      ],
      "passes": true,
      "pathsTouched": ["app/(portal)/dashboard/partners/"],
      "commands": ["pnpm verify"],
      "notes": "Created partner prequal portal with partner list, document checklist (VCA, insurance, references), approval workflow, and document expiry tracking."
    },
    {
      "id": "ADM-100",
      "priority": 70,
      "title": "Analytics dashboard v1: events → KPI tiles",
      "description": "Create analytics dashboard showing KPI tiles from tracked events.",
      "acceptanceCriteria": [
        "/dashboard/analytics shows KPI overview",
        "Leads per month chart",
        "Time-to-first-response metric",
        "Tender win rate",
        "Job views vs applications",
        "Data from analytics events table"
      ],
      "passes": true,
      "pathsTouched": ["app/(portal)/dashboard/analytics/"],
      "commands": ["pnpm verify"],
      "notes": "Created analytics dashboard with KPI tiles (leads, response time, tender win rate, pipeline value), leads per month bar chart, job views vs applications, lead conversion funnel, top pages, and performance highlights."
    },
    {
      "id": "DATA-001",
      "priority": 71,
      "title": "Facility tickets Supabase data layer",
      "description": "Replace mock data in Facility desk with real Supabase implementation. Create facility_tickets table, queries, seed data, and update client to use props.",
      "acceptanceCriteria": [
        "SQL migration for facility_tickets table exists",
        "TypeScript types added to lib/supabase/types.ts",
        "Query functions in lib/supabase/queries.ts (getFacilityTickets, getFacilityTicketById, etc.)",
        "JSON seed data in scripts/seed/facility_tickets.json",
        "Server page fetches data and passes to client",
        "Client component receives data via props (no inline mockTickets)",
        "pnpm verify passes"
      ],
      "passes": true,
      "pathsTouched": [
        "supabase/migrations/00009_create_facility_tickets.sql",
        "lib/supabase/types.ts",
        "lib/supabase/queries.ts",
        "scripts/seed/facility_tickets.json",
        "app/(portal)/dashboard/facility/page.tsx",
        "app/(portal)/dashboard/facility/facility-client.tsx"
      ],
      "commands": ["pnpm verify"],
      "notes": "Created facility_tickets table with reference auto-generation, SLA tracking, RLS policies. TypeScript types added. Query functions with seed fallback. Server page fetches data, client receives via props."
    },
    {
      "id": "DATA-002",
      "priority": 72,
      "title": "Partners Supabase data layer",
      "description": "Replace mock data in Partners prequal with real Supabase implementation. Create partners and partner_documents tables, queries, seed data, and update client to use props.",
      "acceptanceCriteria": [
        "SQL migration for partners and partner_documents tables exists",
        "TypeScript types added to lib/supabase/types.ts",
        "Query functions in lib/supabase/queries.ts (getPartners, getPartnerById, etc.)",
        "JSON seed data in scripts/seed/partners.json",
        "Server page fetches data and passes to client",
        "Client component receives data via props (no inline mockPartners)",
        "pnpm verify passes"
      ],
      "passes": true,
      "pathsTouched": [
        "supabase/migrations/00010_create_partners.sql",
        "lib/supabase/types.ts",
        "lib/supabase/queries.ts",
        "scripts/seed/partners.json",
        "app/(portal)/dashboard/partners/page.tsx",
        "app/(portal)/dashboard/partners/partners-client.tsx"
      ],
      "commands": ["pnpm verify"],
      "notes": "Created partners + partner_documents tables with RLS, audit triggers, compliance status view. TypeScript types added. Query functions including getPartnersWithDocuments for nested data. Server page fetches data, client receives via props."
    },
    {
      "id": "FIX-001",
      "priority": 73,
      "title": "Projectplanner backend integration",
      "description": "Wire projectplanner form submission to API. Currently handleSubmit() is a stub that only waits 1.5s without saving data.",
      "acceptanceCriteria": [
        "API route exists at /api/projectplanner that creates lead",
        "handleSubmit() calls API with form data",
        "Lead created with type 'project' and source 'projectplanner'",
        "Form data stored in lead message/metadata field",
        "Error handling with toast notifications",
        "pnpm verify passes"
      ],
      "passes": true,
      "pathsTouched": [
        "app/api/projectplanner/route.ts",
        "app/(wizard)/projectplanner/page.tsx"
      ],
      "commands": ["pnpm verify"],
      "notes": "Created API route with Zod validation and human-readable message formatting. Updated handleSubmit() to POST to API with toast notifications for success/error."
    },
    {
      "id": "FIX-002",
      "priority": 74,
      "title": "Lead detail page",
      "description": "Create dedicated lead detail page for full lead view. Currently only modal exists.",
      "acceptanceCriteria": [
        "/dashboard/leads/[id] page exists",
        "Shows full lead info (contact, org, message, type, status)",
        "Edit status, owner, next action date inline",
        "Notes section with add/view notes",
        "Activity timeline from audit log",
        "Back link to leads list",
        "pnpm verify passes"
      ],
      "passes": true,
      "pathsTouched": [
        "app/(portal)/dashboard/leads/[id]/page.tsx",
        "app/(portal)/dashboard/leads/[id]/client.tsx"
      ],
      "commands": ["pnpm verify"],
      "notes": "Created full lead detail page with server component fetching lead/notes/profiles. Client component with contact info grid, message display, notes section with add form, and actions sidebar (status, assignment, next action date)."
    },
    {
      "id": "FIX-003",
      "priority": 75,
      "title": "Cases dashboard management",
      "description": "Create cases/referenties dashboard page for managing case studies. Database schema exists but no admin UI.",
      "acceptanceCriteria": [
        "/dashboard/cases page exists",
        "Shows list of all cases with key info",
        "Filter by sector/status",
        "Case detail view/modal",
        "Data from Supabase with seed fallback",
        "pnpm verify passes"
      ],
      "passes": true,
      "pathsTouched": [
        "app/(portal)/dashboard/cases/page.tsx",
        "app/(portal)/dashboard/cases/cases-client.tsx",
        "components/portal/sidebar.tsx"
      ],
      "commands": ["pnpm verify"],
      "notes": "Created cases dashboard with grid view, stats (total/published/featured), filters (search, sector, year), and detail modal with KPIs. Added Cases link to sidebar."
    },
    {
      "id": "FIX-004",
      "priority": 76,
      "title": "Email notifications with Resend",
      "description": "Implement email notifications for contact form submissions and job applications using Resend service.",
      "acceptanceCriteria": [
        "lib/email.ts exists with Resend client setup",
        "Contact form sends notification email to info@deraedt.be",
        "Job application sends confirmation email to applicant",
        "Email templates are professional and match brand",
        "Graceful fallback if email fails (don't block form submission)",
        "pnpm verify passes"
      ],
      "passes": true,
      "pathsTouched": [
        "lib/email.ts",
        "app/api/contact/route.ts",
        "app/api/applications/route.ts",
        "app/(marketing)/werken-bij/[slug]/client.tsx"
      ],
      "commands": ["pnpm verify"],
      "notes": "Created lib/email.ts with Resend integration for 3 email types: contact notification, application confirmation, HR notification. Professional HTML templates with De Raedt branding. Graceful fallback logs emails when RESEND_API_KEY is not configured."
    },
    {
      "id": "FIX-005",
      "priority": 77,
      "title": "DELETE API endpoints for GDPR compliance",
      "description": "Add DELETE endpoints for leads, applications, facility tickets, and tenders to support GDPR right-to-delete.",
      "acceptanceCriteria": [
        "DELETE /api/leads/[id] removes lead and related notes",
        "DELETE /api/applications/[id] removes application and CV",
        "DELETE /api/facility-tickets/[id] removes ticket",
        "DELETE /api/tenders/[id] removes tender (admin only)",
        "All deletes log to audit trail",
        "pnpm verify passes"
      ],
      "passes": true,
      "pathsTouched": [
        "app/api/leads/[id]/route.ts",
        "app/api/applications/[id]/route.ts",
        "app/api/facility-tickets/[id]/route.ts",
        "app/api/tenders/[id]/route.ts"
      ],
      "commands": ["pnpm verify"],
      "notes": "Added DELETE method to all 4 routes. Leads DELETE also removes related notes. Applications DELETE also removes CV from storage. Audit logging handled by existing DB triggers."
    },
    {
      "id": "FIX-006",
      "priority": 78,
      "title": "Board Pack PDF export",
      "description": "Implement PDF export for directie cockpit board pack with KPIs, pipeline status, and alerts.",
      "acceptanceCriteria": [
        "POST /api/export/board-pack generates PDF",
        "PDF contains: KPI tiles, tender pipeline, lead pipeline, expiry radar, alerts",
        "PDF has De Raedt branding (logo, colors)",
        "Download triggers from cockpit 'Board Pack' button",
        "Audit log entry for export action",
        "pnpm verify passes"
      ],
      "passes": true,
      "pathsTouched": [
        "app/api/export/board-pack/route.ts",
        "lib/pdf/board-pack.ts",
        "app/(portal)/dashboard/dashboard-client.tsx"
      ],
      "commands": ["pnpm verify"],
      "notes": "Installed jspdf. Created lib/pdf/board-pack.ts with branded PDF generation. API route fetches data and generates PDF. Dashboard button triggers download."
    },
    {
      "id": "FIX-007",
      "priority": 79,
      "title": "Compliance document upload",
      "description": "Add upload functionality to compliance vault for adding new certificates and documents.",
      "acceptanceCriteria": [
        "POST /api/compliance-docs creates new document record",
        "File upload to Supabase Storage (compliance bucket)",
        "UI upload form in compliance dashboard",
        "Required fields: name, type, issuer, valid_from, valid_to, file",
        "Validation for PDF/image files, max 10MB",
        "pnpm verify passes"
      ],
      "passes": true,
      "pathsTouched": [
        "app/api/compliance-docs/route.ts",
        "app/(portal)/dashboard/compliance/compliance-client.tsx"
      ],
      "commands": ["pnpm verify"],
      "notes": "Created POST/GET /api/compliance-docs with Zod validation. Added upload modal to compliance client with form fields: name, type, issuer, reference, scope, dates, file. File validation for PDF/images max 10MB."
    },
    {
      "id": "FIX-008",
      "priority": 80,
      "title": "Facility ticket creation from dashboard",
      "description": "Add ability to create new facility tickets from dashboard with full details.",
      "acceptanceCriteria": [
        "POST /api/facility-tickets creates new ticket",
        "UI form in facility dashboard for new ticket",
        "Fields: client_name, location, description, urgency, category",
        "Auto-generate ticket reference (FT-YYYY-XXXX)",
        "SLA deadline auto-calculated based on urgency",
        "pnpm verify passes"
      ],
      "passes": true,
      "pathsTouched": [
        "app/api/facility-tickets/route.ts",
        "app/(portal)/dashboard/facility/facility-client.tsx"
      ],
      "commands": ["pnpm verify"],
      "notes": "Created POST/GET /api/facility-tickets with Zod validation. Auto-generates FT-YYYY-XXXX reference. SLA deadline calculated based on urgency (critical=4h, high=8h, medium=24h, low=72h). Added create ticket modal to facility dashboard with all fields."
    },
    {
      "id": "PROD-001",
      "priority": 81,
      "title": "Schema alignment: API routes vs migrations",
      "description": "Fix schema mismatches between API routes and Supabase migrations. compliance-docs API uses 'status' field that doesn't exist. facility-tickets API uses different field names than migration.",
      "acceptanceCriteria": [
        "compliance-docs API matches migration schema (remove status, use correct fields)",
        "facility-tickets API matches migration schema (title, reporter_name/email, sla_due_at)",
        "TypeScript types align with both API and migration",
        "All API routes work against actual Supabase tables",
        "pnpm verify passes"
      ],
      "passes": true,
      "pathsTouched": [
        "app/api/compliance-docs/route.ts",
        "app/api/facility-tickets/route.ts",
        "app/(portal)/dashboard/facility/facility-client.tsx"
      ],
      "commands": ["pnpm verify"],
      "notes": "Removed invalid 'status' field from compliance-docs insert. Fixed facility-tickets to use correct column names: title (generated from client_name + location), reporter_name/email/phone, sla_due_at. Removed category field (not in schema). Made contact fields required."
    },
    {
      "id": "PROD-002",
      "priority": 82,
      "title": "RBAC enforcement on all mutation endpoints",
      "description": "Add role-based access control checks to all DELETE, PATCH, POST endpoints. Currently any authenticated user can delete tenders, leads, applications.",
      "acceptanceCriteria": [
        "DELETE /api/tenders/[id] requires ADMIN or DIRECTIE role",
        "DELETE /api/leads/[id] requires SALES, ADMIN, or DIRECTIE role",
        "DELETE /api/applications/[id] requires HR, ADMIN, or DIRECTIE role",
        "DELETE /api/facility-tickets/[id] requires OPERATIONS, ADMIN, or DIRECTIE role",
        "All mutations return 403 Forbidden for unauthorized roles",
        "pnpm verify passes"
      ],
      "passes": true,
      "pathsTouched": [
        "app/api/tenders/[id]/route.ts",
        "app/api/leads/[id]/route.ts",
        "app/api/applications/[id]/route.ts",
        "app/api/facility-tickets/[id]/route.ts"
      ],
      "commands": ["pnpm verify"],
      "notes": "Added RBAC permission actions to lib/supabase/auth.ts for all delete operations. Added getCurrentUser + canPerformAction checks to all 4 DELETE endpoints. Returns 401 if not authenticated, 403 if insufficient permissions."
    },
    {
      "id": "PROD-003",
      "priority": 83,
      "title": "Cron authentication hardening",
      "description": "Fix cron endpoint security. Currently if CRON_SECRET is not set, authorization is bypassed entirely.",
      "acceptanceCriteria": [
        "Cron endpoint requires CRON_SECRET in all environments",
        "Missing CRON_SECRET returns 401 Unauthorized (not bypass)",
        "Invalid Bearer token returns 401 Unauthorized",
        "Cron endpoint logs all access attempts",
        "pnpm verify passes"
      ],
      "passes": true,
      "pathsTouched": [
        "app/api/cron/tender-ingest/route.ts"
      ],
      "commands": ["pnpm verify"],
      "notes": "Fixed auth bypass by requiring CRON_SECRET always. Returns 500 if not configured, 401 if invalid token. Logs all access attempts with client IP."
    },
    {
      "id": "PROD-004",
      "priority": 84,
      "title": "Seed data dev-only guard",
      "description": "Prevent seed data fallback in production. Currently all query functions fall back to JSON seed data when Supabase is empty or errors.",
      "acceptanceCriteria": [
        "Seed data fallback only happens in development (NODE_ENV !== 'production')",
        "In production, empty/error returns empty array (not seed data)",
        "Console warnings indicate when seed fallback is used in dev",
        "No silent data substitution in production",
        "pnpm verify passes"
      ],
      "passes": true,
      "pathsTouched": [
        "lib/supabase/queries.ts"
      ],
      "commands": ["pnpm verify"],
      "notes": "Added canUseSeedData() helper that returns true only when NODE_ENV !== 'production'. Added getSeedFallback<T>() helper for consistent fallback behavior with logging. Updated all 15+ query functions to use guards: getTenders, getTenderById, getLeads, getLeadById, getJobs, getJobBySlug, getCases, getComplianceDocs, getFacilityTickets, getFacilityTicketById, getPartners, getPartnerById, getPartnerDocuments, getPartnersWithDocuments, getProfiles."
    },
    {
      "id": "PROD-005",
      "priority": 85,
      "title": "Export RBAC + security headers",
      "description": "Add RBAC check to board-pack export and add security headers to all API responses.",
      "acceptanceCriteria": [
        "Board pack export requires DIRECTIE role",
        "Security headers added: X-Content-Type-Options, X-Frame-Options, Strict-Transport-Security",
        "next.config.js or middleware sets security headers globally",
        "Unauthorized export returns 403 Forbidden",
        "pnpm verify passes"
      ],
      "passes": true,
      "pathsTouched": [
        "app/api/export/board-pack/route.ts",
        "next.config.ts"
      ],
      "commands": ["pnpm verify"],
      "notes": "Added RBAC check to board-pack export requiring DIRECTIE role via canPerformAction('export:board-pack'). Added comprehensive security headers in next.config.ts: Strict-Transport-Security (HSTS), X-Content-Type-Options, X-Frame-Options, X-XSS-Protection, Referrer-Policy, Permissions-Policy. Headers applied to all routes via /:path* matcher."
    },
    {
      "id": "PROD-006",
      "priority": 86,
      "title": "Rate limiting on public endpoints",
      "description": "Add IP-based rate limiting to public form endpoints to prevent spam and DoS attacks.",
      "acceptanceCriteria": [
        "lib/rate-limit.ts with sliding window rate limiter",
        "Rate limit: 10 requests per minute for forms",
        "/api/contact, /api/leads, /api/projectplanner, /api/applications rate limited",
        "429 Too Many Requests returned when limit exceeded",
        "Rate limit state persists across requests (use headers or simple store)",
        "pnpm verify passes"
      ],
      "passes": true,
      "pathsTouched": [
        "lib/rate-limit.ts",
        "app/api/contact/route.ts",
        "app/api/leads/route.ts",
        "app/api/projectplanner/route.ts",
        "app/api/applications/route.ts"
      ],
      "commands": ["pnpm verify"],
      "notes": "Created lib/rate-limit.ts with checkRateLimit(), getClientIP(), and RATE_LIMIT_CONFIGS. In-memory sliding window implementation with automatic cleanup. Documented serverless limitations. Added rate limiting to all 4 public form endpoints with 429 response, Retry-After and X-RateLimit headers."
    },
    {
      "id": "PROD-007",
      "priority": 87,
      "title": "Environment validation + email production mode",
      "description": "Add startup validation for required environment variables and make email service fail-fast in production.",
      "acceptanceCriteria": [
        "lib/config.ts validates required env vars at import time",
        "Missing critical env vars throw error at startup (not runtime)",
        "Email service throws error in production if RESEND_API_KEY missing",
        "Email service logs-only in development without API key",
        "Clear error messages for missing configuration",
        "pnpm verify passes"
      ],
      "passes": true,
      "pathsTouched": [
        "lib/config.ts",
        "lib/email.ts"
      ],
      "commands": ["pnpm verify"],
      "notes": "Created lib/config.ts with typed env object and helper functions (isEmailConfigured, isSupabaseConfigured, requireEnv). Updated lib/email.ts to use assertEmailConfigured() - throws in production if RESEND_API_KEY missing, logs in development. Lazy validation approach allows builds to succeed without all env vars."
    },
    {
      "id": "ADM-091",
      "priority": 88,
      "title": "Partner self-service document upload portal",
      "description": "Create a public portal where partners can upload their prequalification documents (VCA, insurance, references) via a unique invite link.",
      "acceptanceCriteria": [
        "/partner-intake/[token] page exists for public document upload",
        "Admin can generate invite link from partner detail modal",
        "Invite link expires after 30 days",
        "Partners can upload VCA, insurance, references documents",
        "Documents uploaded to Supabase Storage",
        "Documents appear as 'pending' in admin for review",
        "Partner can submit when all required docs uploaded",
        "Admin notified of new submissions",
        "pnpm verify passes"
      ],
      "passes": true,
      "pathsTouched": [
        "supabase/migrations/00015_partner_intake_tokens.sql",
        "app/(public)/partner-intake/[token]/page.tsx",
        "app/(public)/partner-intake/[token]/client.tsx",
        "app/api/partner-intake/route.ts",
        "app/api/partner-intake/upload/route.ts",
        "app/api/partners/[id]/invite/route.ts",
        "app/(portal)/dashboard/partners/partners-client.tsx",
        "lib/supabase/auth.ts"
      ],
      "commands": ["pnpm verify"],
      "notes": "Created partner intake token system with 30-day expiry. Public upload page with progress tracking. Admin generates invite link via 'Genereer Upload Link' button. Documents stored in Supabase Storage. RLS policies allow anon uploads with valid token. Added partners:invite and partners:write permissions."
    },
    {
      "id": "I18N-001",
      "priority": 89,
      "title": "Contact page i18n",
      "description": "Add multilingual support to the contact page. Extract all hardcoded Dutch strings to translation files and use useTranslations hook.",
      "acceptanceCriteria": [
        "Contact page uses useTranslations('contact') hook",
        "All 30+ hardcoded Dutch strings moved to messages/*.json",
        "Form labels, placeholders, errors, success messages translated",
        "Company info section translated",
        "Page works correctly in NL, FR, and EN",
        "pnpm verify passes"
      ],
      "passes": true,
      "pathsTouched": [
        "app/[locale]/(marketing)/contact/page.tsx",
        "messages/nl.json",
        "messages/fr.json",
        "messages/en.json"
      ],
      "commands": ["pnpm verify"],
      "notes": "Added useTranslations('contact') hook. Extended contact section in all 3 translation files with hero, cards, form, subjects, success, toast, company, map keys. Uses t.rich() for rich text with highlight tags."
    },
    {
      "id": "I18N-002",
      "priority": 90,
      "title": "Careers (werken-bij) page i18n",
      "description": "Add multilingual support to the careers page. Extract all hardcoded Dutch strings including benefits, culture points, and team section.",
      "acceptanceCriteria": [
        "Werken-bij page uses useTranslations('careers') hook",
        "All 30+ hardcoded Dutch strings moved to messages/*.json",
        "Benefits, culture points, team section translated",
        "Job listings labels translated",
        "Page works correctly in NL, FR, and EN",
        "pnpm verify passes"
      ],
      "passes": true,
      "pathsTouched": [
        "app/[locale]/(marketing)/werken-bij/page.tsx",
        "messages/nl.json",
        "messages/fr.json",
        "messages/en.json"
      ],
      "commands": ["pnpm verify"],
      "notes": "Added useTranslations('careers') hook. Extended careers section in all 3 translation files with hero, stats, employmentTypes, benefitsSection, team, culture, positions, cta keys. Used typed const arrays (BENEFIT_KEYS, CULTURE_KEYS, etc.) for safe key iteration."
    },
    {
      "id": "I18N-003",
      "priority": 91,
      "title": "Projects (projecten) page i18n",
      "description": "Add multilingual support to the projects page. Extract all hardcoded Dutch strings including filters, stats, and CTA sections.",
      "acceptanceCriteria": [
        "Projecten page uses useTranslations('projectsPage') hook",
        "All 20+ hardcoded Dutch strings moved to messages/*.json",
        "Filter labels, stats, CTA sections translated",
        "Search placeholder and empty state translated",
        "Page works correctly in NL, FR, and EN",
        "pnpm verify passes"
      ],
      "passes": true,
      "pathsTouched": [
        "app/[locale]/(marketing)/projecten/page.tsx",
        "messages/nl.json",
        "messages/fr.json",
        "messages/en.json"
      ],
      "commands": ["pnpm verify"],
      "notes": "Added projectsPage section to all 3 translation files with hero, stats, filter, card, cta, empty keys. Used typed const arrays for stats. Updated Link import to use @/i18n/navigation."
    },
    {
      "id": "I18N-004",
      "priority": 92,
      "title": "About (over-ons) page i18n",
      "description": "Add multilingual support to the about page. Extract all hardcoded Dutch strings including mission, story, timeline, values, and team sections.",
      "acceptanceCriteria": [
        "Over-ons page uses useTranslations('aboutPage') hook",
        "All 40+ hardcoded Dutch strings moved to messages/*.json",
        "Mission, story, timeline, 5 V's values translated",
        "Team section and CTA translated",
        "Page works correctly in NL, FR, and EN",
        "pnpm verify passes"
      ],
      "passes": true,
      "pathsTouched": [
        "app/[locale]/(marketing)/over-ons/page.tsx",
        "messages/nl.json",
        "messages/fr.json",
        "messages/en.json"
      ],
      "commands": ["pnpm verify"],
      "notes": "Added aboutPage section to all 3 translation files with hero, stats, mission, story, timeline, values, team, cta keys. Used typed const arrays for values (VALUE_KEYS), timeline (TIMELINE_YEARS), and team features (TEAM_FEATURE_KEYS). Used interpolation for dynamic values."
    },
    {
      "id": "I18N-005",
      "priority": 93,
      "title": "Services (diensten) page i18n",
      "description": "Add multilingual support to the services overview page. Extract all hardcoded Dutch strings including service data, work process, and CTA sections.",
      "acceptanceCriteria": [
        "Diensten page uses useTranslations('servicesPage') hook",
        "All 50+ hardcoded Dutch strings moved to messages/*.json",
        "Service items, work process steps translated",
        "Trust items and CTA sections translated",
        "Page works correctly in NL, FR, and EN",
        "pnpm verify passes"
      ],
      "passes": true,
      "pathsTouched": [
        "app/[locale]/(marketing)/diensten/page.tsx",
        "messages/nl.json",
        "messages/fr.json",
        "messages/en.json"
      ],
      "commands": ["pnpm verify"],
      "notes": "Added servicesPage section to all 3 translation files with hero, stats, nav, services (4 items with features arrays), card, process (5 steps), cta keys. Used typed const arrays (SERVICE_IDS, HERO_STAT_KEYS, PROCESS_STEPS) for safe iteration. Used t.raw() for array translations."
    },
    {
      "id": "I18N-006",
      "priority": 94,
      "title": "Privacy page i18n",
      "description": "Add multilingual support to the privacy policy page. Extract all hardcoded Dutch legal text to translation files.",
      "acceptanceCriteria": [
        "Privacy page uses useTranslations('privacy') hook",
        "All privacy policy sections translated",
        "Legal terminology correctly translated for BE/FR/EN",
        "Page works correctly in NL, FR, and EN",
        "pnpm verify passes"
      ],
      "passes": true,
      "pathsTouched": [
        "app/[locale]/(marketing)/privacy/page.tsx",
        "messages/nl.json",
        "messages/fr.json",
        "messages/en.json"
      ],
      "commands": ["pnpm verify"],
      "notes": "Added comprehensive privacy section to all 3 translation files with 10 sections covering data controller, collection, purposes, legal basis, retention, rights, security, third parties, complaints, and changes. Used typed const arrays (DATA_COLLECTION_KEYS, RIGHTS_KEYS) for safe iteration. Used t.raw() for array translations."
    },
    {
      "id": "I18N-007",
      "priority": 95,
      "title": "Cookies page i18n",
      "description": "Add multilingual support to the cookies policy page. Extract all hardcoded Dutch text to translation files.",
      "acceptanceCriteria": [
        "Cookies page uses useTranslations('cookies') hook",
        "All cookies policy sections translated",
        "Cookie type explanations translated",
        "Page works correctly in NL, FR, and EN",
        "pnpm verify passes"
      ],
      "passes": true,
      "pathsTouched": [
        "app/[locale]/(marketing)/cookies/page.tsx",
        "messages/nl.json",
        "messages/fr.json",
        "messages/en.json"
      ],
      "commands": ["pnpm verify"],
      "notes": "Added comprehensive cookies section to all 3 translation files with sections for what cookies are, cookie types (necessary/analytics), table headers/values, choices, browser management, and contact. Cookie tables include consent and auth cookies."
    },
    {
      "id": "I18N-008",
      "priority": 96,
      "title": "ProjectPlanner wizard i18n",
      "description": "Add multilingual support to the project planner wizard. Extract all form labels, options, and messages to translation files.",
      "acceptanceCriteria": [
        "ProjectPlanner page uses useTranslations('projectPlanner') hook",
        "All 40+ hardcoded Dutch strings moved to messages/*.json",
        "Step titles, options, form labels translated",
        "Success/error messages translated",
        "Page works correctly in NL, FR, and EN",
        "pnpm verify passes"
      ],
      "passes": true,
      "pathsTouched": [
        "app/[locale]/(wizard)/projectplanner/page.tsx",
        "messages/nl.json",
        "messages/fr.json",
        "messages/en.json"
      ],
      "commands": ["pnpm verify"],
      "notes": "Expanded projectPlanner section in all 3 translation files with questions, options (projectTypes, clientTypes, budgets, timelines, locations), form fields, buttons, success/toast messages. Refactored page to use useTranslations hook with typed const arrays for options. Split options helpers into getIconOptionsForQuestion and getTextOptionsForQuestion for type safety."
    },
    {
      "id": "I18N-009",
      "priority": 97,
      "title": "Service detail pages i18n",
      "description": "Add multilingual support to the 4 service detail pages (bouwwerken, dakwerken, erfgoed, facility).",
      "acceptanceCriteria": [
        "All 4 service detail pages use useTranslations hook",
        "Service descriptions, features, CTAs translated",
        "Pages work correctly in NL, FR, and EN",
        "pnpm verify passes"
      ],
      "passes": false,
      "pathsTouched": [
        "app/[locale]/(marketing)/diensten/bouwwerken/page.tsx",
        "app/[locale]/(marketing)/diensten/dakwerken/page.tsx",
        "app/[locale]/(marketing)/diensten/erfgoed/page.tsx",
        "app/[locale]/(marketing)/diensten/facility/page.tsx",
        "messages/nl.json",
        "messages/fr.json",
        "messages/en.json"
      ],
      "commands": ["pnpm verify"],
      "notes": ""
    },
    {
      "id": "I18N-010",
      "priority": 98,
      "title": "Job detail and Partner intake pages i18n",
      "description": "Add multilingual support to job detail page and partner intake page.",
      "acceptanceCriteria": [
        "Job detail page uses useTranslations hook",
        "Partner intake page uses useTranslations hook",
        "Application form, job info sections translated",
        "Partner upload instructions translated",
        "Pages work correctly in NL, FR, and EN",
        "pnpm verify passes"
      ],
      "passes": false,
      "pathsTouched": [
        "app/[locale]/(marketing)/werken-bij/[slug]/page.tsx",
        "app/[locale]/(marketing)/werken-bij/[slug]/client.tsx",
        "app/[locale]/(public)/partner-intake/[token]/page.tsx",
        "app/[locale]/(public)/partner-intake/[token]/client.tsx",
        "messages/nl.json",
        "messages/fr.json",
        "messages/en.json"
      ],
      "commands": ["pnpm verify"],
      "notes": ""
    },
    {
      "id": "I18N-011",
      "priority": 99,
      "title": "Procurement pages i18n",
      "description": "Add multilingual support to procurement overview and documentation pages.",
      "acceptanceCriteria": [
        "Procurement page uses useTranslations hook",
        "Documentatie page uses useTranslations hook",
        "Certifications list, form labels translated",
        "Pages work correctly in NL, FR, and EN",
        "pnpm verify passes"
      ],
      "passes": false,
      "pathsTouched": [
        "app/[locale]/(marketing)/procurement/page.tsx",
        "app/[locale]/(marketing)/procurement/documentatie/page.tsx",
        "app/[locale]/(marketing)/procurement/documentatie/client.tsx",
        "messages/nl.json",
        "messages/fr.json",
        "messages/en.json"
      ],
      "commands": ["pnpm verify"],
      "notes": ""
    },
    {
      "id": "I18N-012",
      "priority": 100,
      "title": "Sustainability (duurzaamheid) page i18n",
      "description": "Add multilingual support to the sustainability page.",
      "acceptanceCriteria": [
        "Duurzaamheid page uses useTranslations hook",
        "Sustainability initiatives translated",
        "Environmental commitments translated",
        "Page works correctly in NL, FR, and EN",
        "pnpm verify passes"
      ],
      "passes": false,
      "pathsTouched": [
        "app/[locale]/(marketing)/duurzaamheid/page.tsx",
        "messages/nl.json",
        "messages/fr.json",
        "messages/en.json"
      ],
      "commands": ["pnpm verify"],
      "notes": ""
    }
  ]
}
